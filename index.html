<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enstars Story Timeline</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Enstars Story Timeline</h1>

<!-- Category Tabs -->
<div class="tabs" id="category-tabs">
  <div class="tab active" data-category="All">All Stories</div>
  <div class="tab" data-category="Main">Main Story</div>
  <div class="tab" data-category="Event">Event Story</div>
  <div class="tab" data-category="Scout">Scout Story</div>
  <div class="tab" data-category="Unit">Unit Story</div>
</div>

<!-- Sort dropdown -->
<div class="sort-container">
  <label for="sort">Sort by: </label>
  <select id="sort">
    <option value="release">Release Order</option>
    <option value="chronological">Chronological</option>
  </select>
</div>

<!-- Search -->
<div class="search-container">
  <input type="text" id="search" placeholder="Search story...">
</div>

<!-- Timeline container -->
<div class="timeline" id="timeline"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

const stories = [
  {id:'s1', title:'Main Story Chapter 1', category:'Main', date:'2025-01-01', characters:['char1','char2'], slug:'story1'},
  {id:'s2', title:'Valentine Event', category:'Event', date:'2025-02-14', characters:['char2','char3'], slug:'story2'},
  {id:'s3', title:'Scout Story: Training', category:'Scout', date:'2025-03-05', characters:['char1'], slug:'story3'},
  {id:'s4', title:'Unit Story: Tricksters', category:'Unit', date:'2025-04-10', characters:['char3','char2'], slug:'story4'}
];

const characterData = {
  'char1':{name:'Character 1', img:'https://via.placeholder.com/50'},
  'char2':{name:'Character 2', img:'https://via.placeholder.com/50'},
  'char3':{name:'Character 3', img:'https://via.placeholder.com/50'}
};

const timeline = document.getElementById('timeline');
const tabs = document.querySelectorAll('.tab');
const searchInput = document.getElementById('search');
const sortSelect = document.getElementById('sort');

function renderTimeline(category='All', searchText='', sortBy='release'){
  timeline.innerHTML='';
  let filtered = stories.filter(s => (category==='All'||s.category===category) &&
                                      s.title.toLowerCase().includes(searchText.toLowerCase()));
  if(sortBy==='chronological'){
    filtered.sort((a,b)=> new Date(a.date)-new Date(b.date));
  } else {
    filtered.sort((a,b)=> a.id.localeCompare(b.id));
  }

  filtered.forEach((story,index)=>{
    const card = document.createElement('div');
    card.className='story-card ' + (index%2===0?'story-left':'story-right');

    // Character icons
    let charIcons = '';
    if(story.characters){
      charIcons = story.characters.map(c => `<img class="character-icon" src="${characterData[c].img}" title="${characterData[c].name}">`).join('');
    }

    card.innerHTML = `
      <div class="story-title">${story.title}</div>
      <div class="story-meta">${story.category} | ${story.date} | ${charIcons}</div>
      <div style="margin-top:5px;"><a href="story.html?slug=${story.slug}">View Story</a></div>
    `;

    timeline.appendChild(card);
  });
}

// Tab switching
tabs.forEach(tab=>{
  tab.addEventListener('click',()=>{
    tabs.forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    renderTimeline(tab.dataset.category, searchInput.value, sortSelect.value);
  });
});

// Search filter
searchInput.addEventListener('input',()=>{
  const activeCategory = document.querySelector('.tab.active').dataset.category;
  renderTimeline(activeCategory, searchInput.value, sortSelect.value);
});

// Sort change
sortSelect.addEventListener('change',()=>{
  const activeCategory = document.querySelector('.tab.active').dataset.category;
  renderTimeline(activeCategory, searchInput.value, sortSelect.value);
});

// Initial render
renderTimeline('All', '', sortSelect.value || 'release');

});
</script>

</body>
</html>
